<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 

<mapper namespace="chat">

<!-- idx에 따라 알람테이블에 code 삽입 -->
 <insert id="addcode" parameterType="HashMap">
	insert into notification (not_UID, fk_idx, not_type, not_message, not_date, not_readcheck, not_remindstatus, not_time, not_URL)
	values(seq_notification_UID.nextval, #{idx}, 5, #{code}, sysdate, default, default, default, 'http://localhost:9090/petopia/chat.pet')
</insert>

<!-- code에 따라 접속  -->
 <select id="viewcode" parameterType="String" resultType="String">
 	select not_message
	from notification
	where DBMS_LOB.INSTR(not_message, #{code})>0
 </select>
 
<!-- idx에 따라 회원정보 가져오기 -->
 <!-- <select id="selectend" parameterType="HashMap" resultType="String">
 	select biz_name, bizidx, docname, memberidx, not_message, userid
	from
	(
	    select b.name as biz_name, idx as bizidx, docname
	    from member b join doctors D
	    on b.idx = d.fk_idx_biz
	    where b.idx=3
	)
	join
	(
	    select m.idx as memberidx, m.userid as userid, not_message
	    from member m join notification c
	    on m.idx = c.fk_idx
	    where m.idx=#{memberidx}
	)
	on 1=1;
 </select> -->
</mapper>