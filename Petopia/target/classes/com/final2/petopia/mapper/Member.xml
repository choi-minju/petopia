<<<<<<< HEAD
<<<<<<< HEAD
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="member">

	<!-- 태그 리스트 보여주기 -->
	<resultMap type="HashMap" id="tagListMap">
		<result property="TAG_UID"	column="tag_UID"	javaType="String"/>
		<result property="TAG_TYPE"	column="tag_type"	javaType="String"/>
		<result property="TAG_NAME"	column="tag_name"	javaType="String"/>
	</resultMap>

	<select id="selectRecommendTagList" resultMap="tagListMap">
		select tag_UID, tag_type, tag_name
		from recommend_tag
		order by tag_UID
	</select>
	
	<!-- *** 회원가입 *** -->
	<!-- 회원가입할 회원번호 받아오기 -->
	<select id="selectMemberSeq" resultType="int">
		select seq_member.nextval
		from dual
	</select>
	
	<!-- member 테이블 insert -->
	<insert id="insertMemberByMvo" parameterType="com.final2.petopia.model.MemberVO">
		insert into member(idx, userid, pwd, name, nickname, birthday, gender, phone, profileimg, fileName, membertype)
		values(#{idx}, #{userid}, #{pwd}, #{name}, #{nickname}, #{birthday}, #{gender}, #{phone}, #{profileimg}, #{fileName}, 1)
	</insert>
	
	<!-- login_log 테이블 insert -->
	<insert id="insertLogin_logByMvo" parameterType="com.final2.petopia.model.MemberVO">
		insert into login_log(idx, fk_userid, fk_pwd, lastlogindate)
		values(#{idx}, #{userid}, #{pwd}, sysdate)
	</insert>
	
	<!-- have_tag 테이블 insert -->
	<insert id="insertHave_tagByTagList" parameterType="HashMap">
		insert into have_tag(fk_tag_UID, fk_idx, fk_tag_name) values
		(#{FK_TAG_UID}, #{FK_IDX}, #{FK_TAG_NAME})
	</insert>
	
	<!-- *** 아이디 중복 체크 *** -->
	<select id="selectMemberIdIsUsed" parameterType="String" resultType="int">
		select count(*)
		from member
		where userid = #{userid}
	</select>

	<!-- 로그인 -->
	<select id="loginSelectByUseridPwd" parameterType="HashMap" resultType="com.final2.petopia.model.MemberVO">
		select a.idx, a.userid, a.pwd, a.name, a.nickname, a.membertype, b.lastlogindate, b.member_status
				, trunc(months_between(sysdate, lastlogindate)) AS lastlogindategap
		from member a JOIN login_log b
		ON a.idx = b.idx
		where b.member_status = 1 and userid = #{USERID} and pwd = #{PWD}
	</select>
	
	<!-- 마지막 로그인 날짜 기록하기 -->
	<update id="updateLoginDateByUserid" parameterType="HashMap">
		update login_log set lastlogindate = sysdate
		where member_status = 1 and fk_userid = #{USERID} and fk_pwd = #{PWD}
	</update>
	
	<!-- *** 아이디로 회원정보 조회 *** -->
	<select id="selectMemberByUserid" parameterType="String" resultType="com.final2.petopia.model.MemberVO">
		select a.idx, a.userid, a.pwd, a.name, a.nickname, a.birthday, a.gender, a.phone
		    , a.profileimg, a.filename, a.membertype, a.point, a.totaldeposit
		    , a.noshow, a.registerdate, b.lastlogindate, b.member_status
		from member a JOIN login_log b
		ON a.idx = b.idx
		where b.member_status = 1 and userid = #{userid}
	</select>
	
	<!-- 저장된 사용자 태그 조회 -->
	<resultMap type="HashMap" id="haveTagListMap">
		<result property="FK_TAG_UID"	column="fk_tag_UID"		javaType="String"/>
		<result property="FK_TAG_NAME"	column="fk_tag_name"	javaType="String"/>
		<result property="FK_IDX"		column="fk_idx"			javaType="String"/>
	</resultMap>
	
	<select id="selectHave_tagByIdx" parameterType="int" resultMap="haveTagListMap">
		select fk_tag_UID, fk_tag_name, fk_idx
		from have_tag
		where fk_idx = #{idx}
	</select>
	
	<!-- *** 회원수정 *** -->
	<!-- member 테이블의 정보수정 -->
	<update id="updateMemberByMvo" parameterType="com.final2.petopia.model.MemberVO">
		update member set pwd = #{pwd}, name = #{name}, nickname = #{nickname}, gender = #{gender}, phone = #{phone}
			, profileimg = #{profileimg}, fileName = #{fileName}
		where idx = #{idx}
	</update>
	
	<!-- login_log 테이블의 정보수정 -->
	<update id="updateLogin_logByMvo" parameterType="com.final2.petopia.model.MemberVO">
		update login_log set fk_pwd = #{pwd}
		where idx = #{idx}
	</update>
	
	<!-- 해당 사용자의 태그 모두 지우기 -->
	<delete id="deleteHave_tagByIdx" parameterType="int">
		delete from have_tag where fk_idx = #{idx}
	</delete>
	
=======
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 

<mapper namespace="member">

	<!-- 태그 리스트 보여주기 -->
	<resultMap type="HashMap" id="tagListMap">
		<result property="TAG_UID"	column="tag_UID"	javaType="String"/>
		<result property="TAG_TYPE"	column="tag_type"	javaType="String"/>
		<result property="TAG_NAME"	column="tag_name"	javaType="String"/>
	</resultMap>

	<select id="selectRecommendTagList" resultMap="tagListMap">
		select tag_UID, tag_type, tag_name
		from recommend_tag
		order by tag_UID
	</select>
	
	<!-- *** 회원가입 *** -->
	<!-- 회원가입할 회원번호 받아오기 -->
	<select id="selectMemberSeq" resultType="int">
		select seq_member.nextval
		from dual
	</select>
	
	<!-- member 테이블 insert -->
	<insert id="insertMemberByMvo" parameterType="com.final2.petopia.model.MemberVO">
		insert into member(idx, userid, pwd, name, nickname, birthday, gender, phone, profileimg, fileName, membertype)
		values(#{idx}, #{userid}, #{pwd}, #{name}, #{nickname}, #{birthday}, #{gender}, #{phone}, #{profileimg}, #{fileName}, 1)
	</insert>
	
	<!-- login_log 테이블 insert -->
	<insert id="insertLogin_logByMvo" parameterType="com.final2.petopia.model.MemberVO">
		insert into login_log(idx, fk_userid, fk_pwd, lastlogindate)
		values(#{idx}, #{userid}, #{pwd}, sysdate)
	</insert>
	
	<!-- have_tag 테이블 insert -->
	<insert id="insertHave_tagByTagList" parameterType="HashMap">
		insert into have_tag(fk_tag_UID, fk_idx, fk_tag_name) values
		(#{FK_TAG_UID}, #{FK_IDX}, #{FK_TAG_NAME})
	</insert>
	
	<!-- *** 아이디 중복 체크 *** -->
	<select id="selectMemberIdIsUsed" parameterType="String" resultType="int">
		select count(*)
		from member
		where userid = #{userid}
	</select>

	<!-- 로그인 -->
	<select id="loginSelectByUseridPwd" parameterType="HashMap" resultType="com.final2.petopia.model.MemberVO">
		select a.idx, a.userid, a.pwd, a.name, a.nickname, a.membertype, b.lastlogindate, b.member_status
				, trunc(months_between(sysdate, lastlogindate)) AS lastlogindategap
		from member a JOIN login_log b
		ON a.idx = b.idx
		where b.member_status = 1 and userid = #{USERID} and pwd = #{PWD}
	</select>
	
	<!-- 마지막 로그인 날짜 기록하기 -->
	<update id="updateLoginDateByUserid" parameterType="HashMap">
		update login_log set lastlogindate = sysdate
		where member_status = 1 and fk_userid = #{USERID} and fk_pwd = #{PWD}
	</update>
	
	<!-- *** 아이디로 회원정보 조회 *** -->
	<select id="selectMemberByUserid" parameterType="String" resultType="com.final2.petopia.model.MemberVO">
		select a.idx, a.userid, a.pwd, a.name, a.nickname, a.birthday, a.gender, a.phone
		    , a.profileimg, a.filename, a.membertype, a.point, a.totaldeposit
		    , a.noshow, a.registerdate, b.lastlogindate, b.member_status
		from member a JOIN login_log b
		ON a.idx = b.idx
		where b.member_status = 1 and userid = #{userid}
	</select>
	
	<!-- 저장된 사용자 태그 조회 -->
	<resultMap type="HashMap" id="haveTagListMap">
		<result property="FK_TAG_UID"	column="fk_tag_UID"		javaType="String"/>
		<result property="FK_TAG_NAME"	column="fk_tag_name"	javaType="String"/>
		<result property="FK_IDX"		column="fk_idx"			javaType="String"/>
	</resultMap>
	
	<select id="selectHave_tagByIdx" parameterType="int" resultMap="haveTagListMap">
		select fk_tag_UID, fk_tag_name, fk_idx
		from have_tag
		where fk_idx = #{idx}
	</select>
	
	<!-- *** 회원수정 *** -->
	<!-- member 테이블의 정보수정 -->
	<update id="updateMemberByMvo" parameterType="com.final2.petopia.model.MemberVO">
		update member set pwd = #{pwd}, name = #{name}, nickname = #{nickname}, gender = #{gender}, phone = #{phone}
			, profileimg = #{profileimg}, fileName = #{fileName}
		where idx = #{idx}
	</update>
	
	<!-- login_log 테이블의 정보수정 -->
	<update id="updateLogin_logByMvo" parameterType="com.final2.petopia.model.MemberVO">
		update login_log set fk_pwd = #{pwd}
		where idx = #{idx}
	</update>
	
	<!-- 해당 사용자의 태그 모두 지우기 -->
	<delete id="deleteHave_tagByIdx" parameterType="int">
		delete from have_tag where fk_idx = #{idx}
	</delete>
	
>>>>>>> refs/remotes/origin/hohywan
=======
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 

<mapper namespace="member">

	<!-- 태그 리스트 보여주기 -->
	<resultMap type="HashMap" id="tagListMap">
		<result property="TAG_UID"	column="tag_UID"	javaType="String"/>
		<result property="TAG_TYPE"	column="tag_type"	javaType="String"/>
		<result property="TAG_NAME"	column="tag_name"	javaType="String"/>
	</resultMap>

	<select id="selectRecommendTagList" resultMap="tagListMap">
		select tag_UID, tag_type, tag_name
		from recommend_tag
		order by tag_UID
	</select>
	
	<!-- *** 회원가입 *** -->
	<!-- 회원가입할 회원번호 받아오기 -->
	<select id="selectMemberSeq" resultType="int">
		select seq_member.nextval
		from dual
	</select>
	
	<!-- member 테이블 insert -->
	<insert id="insertMemberByMvo" parameterType="com.final2.petopia.model.MemberVO">
		insert into member(idx, userid, pwd, name, nickname, birthday, gender, phone, profileimg, fileName, membertype)
		values(#{idx}, #{userid}, #{pwd}, #{name}, #{nickname}, #{birthday}, #{gender}, #{phone}, #{profileimg}, #{fileName}, 1)
	</insert>
	
	<!-- login_log 테이블 insert -->
	<insert id="insertLogin_logByMvo" parameterType="com.final2.petopia.model.MemberVO">
		insert into login_log(idx, fk_userid, fk_pwd, lastlogindate)
		values(#{idx}, #{userid}, #{pwd}, sysdate)
	</insert>
	
	<!-- have_tag 테이블 insert -->
	<insert id="insertHave_tagByTagList" parameterType="HashMap">
		insert into have_tag(fk_tag_UID, fk_idx, fk_tag_name) values
		(#{FK_TAG_UID}, #{FK_IDX}, #{FK_TAG_NAME})
	</insert>
	
	<!-- *** 아이디 중복 체크 *** -->
	<select id="selectMemberIdIsUsed" parameterType="String" resultType="int">
		select count(*)
		from member
		where userid = #{userid}
	</select>

	<!-- 로그인 -->
	<select id="loginSelectByUseridPwd" parameterType="HashMap" resultType="com.final2.petopia.model.MemberVO">
		select a.idx, a.userid, a.pwd, a.name, a.nickname, a.membertype, b.lastlogindate, b.member_status
				, trunc(months_between(sysdate, lastlogindate)) AS lastlogindategap
		from member a JOIN login_log b
		ON a.idx = b.idx
		where b.member_status = 1 and userid = #{USERID} and pwd = #{PWD}
	</select>
	
	<!-- 마지막 로그인 날짜 기록하기 -->
	<update id="updateLoginDateByUserid" parameterType="HashMap">
		update login_log set lastlogindate = sysdate
		where member_status = 1 and fk_userid = #{USERID} and fk_pwd = #{PWD}
	</update>
	
	<!-- *** 아이디로 회원정보 조회 *** -->
	<select id="selectMemberByUserid" parameterType="String" resultType="com.final2.petopia.model.MemberVO">
		select a.idx, a.userid, a.pwd, a.name, a.nickname, a.birthday, a.gender, a.phone
		    , a.profileimg, a.filename, a.membertype, a.point, a.totaldeposit
		    , a.noshow, a.registerdate, b.lastlogindate, b.member_status
		from member a JOIN login_log b
		ON a.idx = b.idx
		where b.member_status = 1 and userid = #{userid}
	</select>
	
	<!-- 저장된 사용자 태그 조회 -->
	<resultMap type="HashMap" id="haveTagListMap">
		<result property="FK_TAG_UID"	column="fk_tag_UID"		javaType="String"/>
		<result property="FK_TAG_NAME"	column="fk_tag_name"	javaType="String"/>
		<result property="FK_IDX"		column="fk_idx"			javaType="String"/>
	</resultMap>
	
	<select id="selectHave_tagByIdx" parameterType="int" resultMap="haveTagListMap">
		select fk_tag_UID, fk_tag_name, fk_idx
		from have_tag
		where fk_idx = #{idx}
	</select>
	
	<!-- *** 회원수정 *** -->
	<!-- member 테이블의 정보수정 -->
	<update id="updateMemberByMvo" parameterType="com.final2.petopia.model.MemberVO">
		update member set pwd = #{pwd}, name = #{name}, nickname = #{nickname}, gender = #{gender}, phone = #{phone}
			, profileimg = #{profileimg}, fileName = #{fileName}
		where idx = #{idx}
	</update>
	
	<!-- login_log 테이블의 정보수정 -->
	<update id="updateLogin_logByMvo" parameterType="com.final2.petopia.model.MemberVO">
		update login_log set fk_pwd = #{pwd}
		where idx = #{idx}
	</update>
	
	<!-- 해당 사용자의 태그 모두 지우기 -->
	<delete id="deleteHave_tagByIdx" parameterType="int">
		delete from have_tag where fk_idx = #{idx}
	</delete>
	
>>>>>>> refs/remotes/origin/goeun
</mapper>